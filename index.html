<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –º–µ—Ç–∞—Ç–µ–≥ viewport –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TIME WARRIORS: Master of Tenses</title>
    <style>
        :root {
            --primary: #0f0c29;
            --secondary: #302b63;
            --accent: #24243e;
            --neon: #00f7ff;
            --pink: #ff00aa;
            --gold: #ffd700;
            --white: #ffffff;
            --gray: #333;
            --light-gray: #eee;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        html {
            font-size: 16px;
            height: 100%;
            /* –†–∞–∑—Ä–µ—à–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É */
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        body {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            background-attachment: fixed;
            color: var(--white);
            min-height: 100vh;
            padding: clamp(10px, 3vw, 20px);
            /* –†–∞–∑—Ä–µ—à–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É */
            overflow-x: hidden;
            overflow-y: auto;
            line-height: 1.5;
            -webkit-text-size-adjust: 100%;
            -webkit-font-smoothing: antialiased;
        }

        .container {
            width: 100%;
            max-width: min(1200px, 95vw);
            margin: 0 auto;
            padding: 0 clamp(5px, 2vw, 10px);
            /* –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –≤—ã—Å–æ—Ç—É */
            min-height: auto;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ */
        header {
            text-align: center;
            padding: clamp(15px, 4vw, 20px) 10px;
            animation: pulse 2s infinite alternate;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        @keyframes pulse {
            from { transform: scale(1); }
            to { transform: scale(1.02); }
        }

        h1 {
            font-size: clamp(1.8rem, 6vw, 2.5rem);
            color: var(--neon);
            text-shadow: 0 0 10px var(--neon);
            margin-bottom: clamp(8px, 2vw, 10px);
            line-height: 1.2;
            font-weight: 700;
            letter-spacing: -0.5px;
            word-break: break-word;
        }

        .subtitle {
            font-size: clamp(1rem, 3.5vw, 1.2rem);
            color: var(--pink);
            margin-bottom: clamp(15px, 4vw, 20px);
            line-height: 1.3;
            font-weight: 500;
            padding: 0 10px;
        }

        /* –ù–∞—á–∞–ª—å–Ω–æ–µ –º–µ–Ω—é */
        .start-menu {
            text-align: center;
            padding: clamp(20px, 5vw, 40px) clamp(15px, 4vw, 20px);
            background: rgba(0,0,0,0.5);
            border-radius: clamp(15px, 4vw, 20px);
            margin: clamp(15px, 4vw, 40px) auto;
            width: 100%;
            max-width: min(800px, 95vw);
            box-shadow: 0 0 30px rgba(0,255,255,0.2);
            /* –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º, —á—Ç–æ –º–µ–Ω—é –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –≤—ã—Å–æ—Ç—É */
            min-height: auto;
            overflow: visible;
        }

        .start-menu h2 {
            color: var(--gold);
            margin-bottom: clamp(20px, 5vw, 30px);
            font-size: clamp(1.5rem, 5vw, 2rem);
            line-height: 1.2;
            word-wrap: break-word;
            padding: 0 10px;
        }

        .menu-description {
            font-size: clamp(0.95rem, 3vw, 1.1rem);
            line-height: 1.5;
            margin-bottom: clamp(20px, 5vw, 40px);
            color: var(--light-gray);
            text-align: center;
            padding: 0 clamp(10px, 3vw, 20px);
        }

        .menu-description p {
            margin-bottom: clamp(10px, 3vw, 15px);
        }

        .start-buttons {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: clamp(15px, 4vw, 20px);
            margin-bottom: clamp(20px, 5vw, 30px);
            width: 100%;
        }

        .start-btn {
            padding: clamp(15px, 4vw, 18px) clamp(20px, 5vw, 32px);
            background: linear-gradient(45deg, var(--neon), var(--pink));
            color: var(--primary);
            border: none;
            border-radius: clamp(10px, 3vw, 12px);
            cursor: pointer;
            font-weight: bold;
            font-size: clamp(1rem, 3.5vw, 1.2rem);
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 5px 15px rgba(0, 247, 255, 0.3);
            width: 100%;
            max-width: min(400px, 90vw);
            min-height: clamp(50px, 10vw, 60px);
            display: flex;
            align-items: center;
            justify-content: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .start-btn:active {
            transform: translateY(-2px);
        }

        .start-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 247, 255, 0.5);
            background: linear-gradient(45deg, var(--pink), var(--neon));
        }

        .start-btn.final-test {
            background: linear-gradient(45deg, var(--gold), #ff9900);
            font-size: clamp(1.1rem, 4vw, 1.3rem);
            padding: clamp(16px, 4.5vw, 20px) clamp(25px, 6vw, 40px);
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é —Å –≤–∫–ª–∞–¥–∫–∞–º–∏ */
        .main-menu {
            display: flex;
            flex-wrap: wrap;
            gap: clamp(8px, 2vw, 10px);
            justify-content: center;
            margin-bottom: clamp(20px, 5vw, 30px);
            background: rgba(0,0,0,0.3);
            padding: clamp(12px, 3vw, 15px);
            border-radius: clamp(12px, 3vw, 15px);
            box-shadow: 0 0 20px rgba(0,255,255,0.2);
            display: none;
        }

        .tab {
            padding: clamp(10px, 2.5vw, 12px) clamp(15px, 3vw, 20px);
            background: var(--accent);
            border: 2px solid var(--neon);
            border-radius: clamp(8px, 2vw, 10px);
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            font-size: clamp(0.8rem, 2.5vw, 0.9rem);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            text-align: center;
            flex: 1 0 calc(33.333% - 20px);
            min-width: 120px;
            max-width: 200px;
            word-wrap: break-word;
            overflow-wrap: break-word;
            min-height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .tab:active {
            transform: translateY(-1px);
        }

        .tab:hover, .tab.active {
            background: var(--neon);
            color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 0 15px var(--neon);
        }

        .back-to-menu {
            display: block;
            margin: clamp(15px, 4vw, 20px) auto;
            padding: clamp(10px, 3vw, 12px) clamp(20px, 4vw, 24px);
            background: var(--gray);
            color: var(--white);
            border: 2px solid var(--light-gray);
            border-radius: clamp(6px, 2vw, 8px);
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            width: 100%;
            max-width: min(250px, 80vw);
            font-size: clamp(0.9rem, 3vw, 1rem);
            min-height: 45px;
        }

        .back-to-menu:active {
            transform: scale(0.98);
        }

        .back-to-menu:hover {
            background: var(--light-gray);
            color: var(--primary);
            transform: scale(1.02);
        }

        /* –ò–≥—Ä–æ–≤–∞—è –æ–±–ª–∞—Å—Ç—å */
        .game-area {
            background: rgba(0,0,0,0.5);
            padding: clamp(15px, 4vw, 20px);
            border-radius: clamp(12px, 3vw, 15px);
            box-shadow: 0 0 30px rgba(0,255,255,0.1);
            /* –£–±—Ä–∞–Ω–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ min-height */
            min-height: auto;
            display: none;
            width: 100%;
            margin: 0 auto;
            /* –†–∞–∑—Ä–µ—à–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É –≤–Ω—É—Ç—Ä–∏ –∏–≥—Ä–æ–≤–æ–π –æ–±–ª–∞—Å—Ç–∏ */
            overflow-y: auto;
            max-height: 80vh;
        }

        .game-area.active {
            display: block;
        }

        .progress-bar {
            width: 100%;
            height: clamp(8px, 2vw, 10px);
            background: var(--gray);
            border-radius: clamp(4px, 1.5vw, 5px);
            margin: clamp(15px, 4vw, 20px) 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--pink), var(--neon));
            width: 0%;
            transition: width 0.5s ease;
        }

        .test-progress {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: clamp(15px, 4vw, 20px) 0;
            font-size: clamp(0.95rem, 3vw, 1.1rem);
        }

        @media (min-width: 480px) {
            .test-progress {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }
        }

        .question-counter {
            background: rgba(0,255,255,0.1);
            padding: clamp(6px, 2vw, 8px) clamp(12px, 3vw, 16px);
            border-radius: 20px;
            font-weight: bold;
            text-align: center;
            white-space: nowrap;
        }

        .question {
            font-size: clamp(1.2rem, 4vw, 1.5rem);
            margin: clamp(15px, 4vw, 20px) 0;
            padding: clamp(15px, 4vw, 20px);
            background: rgba(255,255,255,0.1);
            border-radius: clamp(8px, 2vw, 10px);
            text-align: center;
            box-shadow: 0 0 15px rgba(0,255,255,0.1);
            line-height: 1.4;
            word-wrap: break-word;
            overflow-wrap: break-word;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .options {
            display: grid;
            grid-template-columns: 1fr;
            gap: clamp(10px, 3vw, 15px);
            margin: clamp(15px, 4vw, 20px) 0;
        }

        @media (min-width: 480px) {
            .options {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 768px) {
            .options {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
        }

        .option {
            padding: clamp(12px, 3vw, 15px);
            background: var(--accent);
            border: 2px solid transparent;
            border-radius: clamp(8px, 2vw, 10px);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: clamp(0.95rem, 3vw, 1.1rem);
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            word-wrap: break-word;
            overflow-wrap: break-word;
            line-height: 1.3;
            user-select: none;
        }

        .option:active {
            transform: scale(0.98);
        }

        .option:hover {
            border-color: var(--neon);
            transform: scale(1.02);
        }

        .option.correct {
            background: linear-gradient(to right, var(--gold), var(--pink));
            color: var(--primary);
            border-color: var(--gold);
            animation: correct 0.5s ease-in-out;
        }

        .option.wrong {
            background: linear-gradient(to right, #ff416c, #ff4b2b);
            color: var(--white);
            border-color: #ff416c;
            animation: wrong 0.5s ease-in-out;
        }

        @keyframes correct {
            0% { transform: scale(0.95); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes wrong {
            0% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            100% { transform: translateX(0); }
        }

        .hint {
            margin-top: clamp(15px, 4vw, 20px);
            padding: clamp(12px, 3vw, 15px);
            background: rgba(0,255,255,0.1);
            border-left: 5px solid var(--neon);
            border-radius: clamp(4px, 1.5vw, 5px);
            display: none;
            font-size: clamp(0.9rem, 3vw, 1rem);
            line-height: 1.4;
            word-wrap: break-word;
        }

        .stats {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: clamp(15px, 4vw, 20px) 0;
            font-size: clamp(0.95rem, 3vw, 1.1rem);
        }

        @media (min-width: 480px) {
            .stats {
                flex-direction: row;
                justify-content: space-between;
            }
        }

        .stats span {
            background: rgba(255,255,255,0.1);
            padding: clamp(8px, 2vw, 10px);
            border-radius: clamp(6px, 2vw, 8px);
            text-align: center;
            flex: 1;
            min-width: 120px;
        }

        .btn {
            padding: clamp(10px, 3vw, 12px) clamp(15px, 4vw, 24px);
            background: var(--neon);
            color: var(--primary);
            border: none;
            border-radius: clamp(6px, 2vw, 8px);
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: clamp(5px, 2vw, 10px);
            font-size: clamp(0.9rem, 3vw, 1rem);
            min-height: 45px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            white-space: nowrap;
            max-width: 100%;
        }

        .btn:active {
            transform: scale(0.95);
        }

        .btn:hover {
            background: var(--pink);
            transform: scale(1.05);
            box-shadow: 0 0 15px var(--pink);
        }

        .btn-reset {
            background: #ff416c;
            color: white;
        }

        .btn-reset:hover {
            background: #ff4b2b;
        }

        .level-complete {
            text-align: center;
            padding: clamp(20px, 5vw, 30px);
            background: rgba(0,255,255,0.1);
            border-radius: clamp(12px, 3vw, 15px);
            display: none;
            width: 100%;
        }

        .level-complete h2 {
            color: var(--gold);
            font-size: clamp(1.5rem, 5vw, 2rem);
            margin-bottom: clamp(10px, 3vw, 10px);
            line-height: 1.2;
        }

        .level-complete p {
            font-size: clamp(1rem, 3.5vw, 1.2rem);
            margin-bottom: clamp(15px, 4vw, 20px);
        }

        .final-results {
            text-align: center;
            padding: clamp(25px, 6vw, 40px);
            background: rgba(0,0,0,0.7);
            border-radius: clamp(15px, 4vw, 20px);
            margin: clamp(15px, 4vw, 20px) 0;
            display: none;
            width: 100%;
            /* –†–∞–∑—Ä–µ—à–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É –≤–Ω—É—Ç—Ä–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */
            overflow-y: auto;
        }

        .final-results h2 {
            color: var(--gold);
            font-size: clamp(1.8rem, 6vw, 2.5rem);
            margin-bottom: clamp(15px, 4vw, 20px);
            line-height: 1.2;
            word-wrap: break-word;
        }

        .final-score {
            font-size: clamp(2.5rem, 10vw, 4rem);
            font-weight: bold;
            color: var(--neon);
            margin: clamp(15px, 4vw, 20px) 0;
            text-shadow: 0 0 20px var(--neon);
            line-height: 1;
        }

        .grade {
            font-size: clamp(1.5rem, 5vw, 2rem);
            color: var(--pink);
            margin-bottom: clamp(20px, 5vw, 30px);
            font-weight: bold;
            line-height: 1.3;
        }

        .result-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: clamp(10px, 3vw, 15px);
            margin: clamp(20px, 5vw, 30px) 0;
        }

        .result-item {
            background: rgba(255,255,255,0.1);
            padding: clamp(10px, 3vw, 12px) clamp(8px, 2vw, 10px);
            border-radius: clamp(8px, 2vw, 10px);
            text-align: center;
            font-size: clamp(0.9rem, 3vw, 1rem);
            min-height: 70px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            word-wrap: break-word;
        }

        .confetti {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        .confetti-piece {
            position: absolute;
            width: 8px;
            height: 8px;
            background: var(--neon);
            animation: fall 3s linear forwards;
        }

        @keyframes fall {
            to {
                transform: translateY(100vh) rotate(360deg);
            }
        }

        .footer {
            text-align: center;
            margin-top: clamp(20px, 5vw, 30px);
            padding: clamp(8px, 2vw, 10px);
            font-size: clamp(0.8rem, 2.5vw, 0.9rem);
            color: var(--light-gray);
            line-height: 1.4;
            word-wrap: break-word;
            margin-bottom: 20px; /* –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É –¥–ª—è —Å–∫—Ä–æ–ª–ª–∞ */
        }

        /* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
        @media (max-width: 360px) {
            html {
                font-size: 14px;
            }
            
            .tab {
                flex: 1 0 calc(50% - 10px);
                min-width: 100px;
                font-size: 0.7rem;
                padding: 8px 10px;
            }
            
            .question {
                font-size: 1.1rem;
                padding: 12px;
                min-height: 70px;
            }
            
            .option {
                font-size: 0.9rem;
                padding: 10px;
                min-height: 55px;
            }
        }

        /* –õ–∞–Ω–¥—à–∞—Ñ—Ç–Ω–∞—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
        @media (orientation: landscape) and (max-height: 600px) {
            body {
                padding: 10px;
            }
            
            .container {
                max-width: 100%;
            }
            
            .start-menu {
                padding: 15px 10px;
                margin: 10px auto;
            }
            
            .game-area {
                /* –í –ª–∞–Ω–¥—à–∞—Ñ—Ç–Ω–æ–º —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–µ—à–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É */
                max-height: 70vh;
                overflow-y: auto;
            }
            
            .question {
                font-size: 1.2rem;
                padding: 10px;
                min-height: 60px;
            }
            
            .option {
                padding: 10px;
                min-height: 50px;
                font-size: 0.9rem;
            }
            
            .main-menu {
                padding: 10px;
            }
            
            .tab {
                flex: 1 0 calc(25% - 10px);
                font-size: 0.7rem;
                min-height: 40px;
            }
        }

        /* –ü–ª–∞–Ω—à–µ—Ç—ã */
        @media (min-width: 768px) and (max-width: 1023px) {
            .container {
                max-width: 90vw;
            }
            
            .start-btn {
                max-width: 350px;
            }
            
            .tab {
                flex: 1 0 calc(25% - 10px);
            }
        }

        /* –î–µ—Å–∫—Ç–æ–ø */
        @media (min-width: 1024px) {
            .container {
                max-width: 1200px;
            }
            
            body {
                padding: 30px;
            }
            
            .tab {
                flex: 1 0 calc(16.666% - 10px);
                max-width: 150px;
            }
        }

        /* –†–∞–∑—Ä–µ—à–∞–µ–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ */
        html {
            -webkit-text-size-adjust: 100%;
        }
        
        body {
            -webkit-text-size-adjust: 100%;
        }
        
        /* –£–ª—É—á—à–µ–Ω–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –¥–ª—è iOS */
        .scrollable {
            -webkit-overflow-scrolling: touch;
        }
        
        /* –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º, —á—Ç–æ body –º–æ–∂–Ω–æ –ø—Ä–æ–∫—Ä—É—á–∏–≤–∞—Ç—å */
        @media (max-height: 700px) {
            body {
                overflow-y: scroll;
            }
            
            .start-menu, .game-area, .final-results {
                margin-bottom: 50px;
            }
        }

        /* –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞—Å–∞–Ω–∏–π */
        @media (hover: none) {
            .btn:hover, .start-btn:hover, .tab:hover, .option:hover, .back-to-menu:hover {
                transform: none;
            }
            
            .btn:active, .start-btn:active, .tab:active, .option:active, .back-to-menu:active {
                transform: scale(0.95);
            }
        }

        /* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã */
        @media (prefers-color-scheme: dark) {
            :root {
                --primary: #0a081f;
                --secondary: #1e1a40;
                --accent: #1a1830;
                --gray: #222;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>‚è∞ TIME WARRIORS</h1>
            <p class="subtitle">Master the Tenses. Conquer Time Expressions.</p>
        </header>

        <!-- –ù–∞—á–∞–ª—å–Ω–æ–µ –º–µ–Ω—é -->
        <div class="start-menu" id="start-menu">
            <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ TIME WARRIORS!</h2>
            <div class="menu-description">
                <p>üéØ <strong>–¶–µ–ª—å –∏–≥—Ä—ã:</strong> –ù–∞—É—á–∏—Ç—å—Å—è –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –≤—Ä–µ–º–µ–Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —è–∑—ã–∫–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–º –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º.</p>
                <p>üìö <strong>–ö–∞–∫ –∏–≥—Ä–∞—Ç—å:</strong> –í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∏–ª–∏ –ø—Ä–æ–π–¥–∏—Ç–µ –æ–±—É—á–µ–Ω–∏–µ –ø–æ –∫–∞–∂–¥–æ–º—É –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–¥–µ–ª—å–Ω–æ.</p>
                <p>üèÜ <strong>–§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç:</strong> –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤–æ–∏ –∑–Ω–∞–Ω–∏—è –ø–æ –≤—Å–µ–º –≤—Ä–µ–º–µ–Ω–∞–º —Å—Ä–∞–∑—É!</p>
            </div>
            <div class="start-buttons">
                <button class="start-btn" id="start-training">üéÆ –ù–∞—á–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ</button>
                <button class="start-btn final-test" id="start-final-test">üèÜ –§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç</button>
            </div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é —Å –≤–∫–ª–∞–¥–∫–∞–º–∏ -->
        <div class="main-menu" id="main-menu">
            <div class="tab" data-tab="present-simple">Present Simple</div>
            <div class="tab" data-tab="present-continuous">Present Continuous</div>
            <div class="tab" data-tab="present-perfect">Present Perfect</div>
            <div class="tab" data-tab="present-perfect-continuous">Present Perfect Continuous</div>
            <div class="tab" data-tab="past-simple">Past Simple</div>
            <div class="tab" data-tab="past-continuous">Past Continuous</div>
            <div class="tab" data-tab="past-perfect">Past Perfect</div>
            <div class="tab" data-tab="past-perfect-continuous">Past Perfect Continuous</div>
            <div class="tab" data-tab="future-simple">Future Simple</div>
            <div class="tab" data-tab="future-continuous">Future Continuous</div>
            <div class="tab" data-tab="future-perfect">Future Perfect</div>
            <div class="tab" data-tab="future-perfect-continuous">Future Perfect Continuous</div>
            <div class="tab" data-tab="future-be-going-to">Future Be Going To</div>
            <button class="back-to-menu" id="back-to-main">‚Üê –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é</button>
        </div>

        <!-- –ò–≥—Ä–æ–≤—ã–µ –æ–±–ª–∞—Å—Ç–∏ -->
        <div id="present-simple" class="game-area">
            <div class="progress-bar"><div class="progress-fill" id="present-simple-progress"></div></div>
            <div class="question" id="present-simple-question">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            <div class="options" id="present-simple-options"></div>
            <div class="hint" id="present-simple-hint"></div>
            <div class="stats">
                <span>–ü—Ä–∞–≤–∏–ª—å–Ω–æ: <span id="present-simple-correct">0</span></span>
                <span>–í—Å–µ–≥–æ: <span id="present-simple-total">0</span></span>
            </div>
            <button class="btn btn-next" id="present-simple-next">–°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å</button>
            <div class="level-complete" id="present-simple-level-complete">
                <h2>üéâ –£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–π–¥–µ–Ω!</h2>
                <p>–í—ã –æ—Ç–ª–∏—á–Ω–æ —Å–ø—Ä–∞–≤–∏–ª–∏—Å—å —Å Present Simple!</p>
                <button class="btn btn-next-level" data-next="present-continuous">–ü–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É</button>
                <button class="btn back-to-menu">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é</button>
            </div>
        </div>

        <!-- –§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç -->
        <div id="final-test" class="game-area">
            <div class="progress-bar"><div class="progress-fill" id="final-test-progress"></div></div>
            <div class="test-progress">
                <div class="question-counter">–í–æ–ø—Ä–æ—Å <span id="current-question">1</span> –∏–∑ <span id="total-questions">100</span></div>
                <div>–ü—Ä–∞–≤–∏–ª—å–Ω–æ: <span id="final-test-correct">0</span></div>
            </div>
            <div class="question" id="final-test-question">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            <div class="options" id="final-test-options"></div>
            <div class="hint" id="final-test-hint"></div>
            <button class="btn btn-next" id="final-test-next">–°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å</button>
            
            <div class="final-results" id="final-test-results">
                <h2>üèÜ –§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç –∑–∞–≤–µ—Ä—à—ë–Ω!</h2>
                <div class="final-score" id="final-score">0%</div>
                <div class="grade" id="final-grade">–ù–∞—á–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å</div>
                <div class="result-details">
                    <div class="result-item">–í—Å–µ–≥–æ –≤–æ–ø—Ä–æ—Å–æ–≤: <span id="result-total">0</span></div>
                    <div class="result-item">–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: <span id="result-correct">0</span></div>
                    <div class="result-item">–ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö: <span id="result-percentage">0%</span></div>
                    <div class="result-item">–í—Ä–µ–º—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è: <span id="result-time">0 —Å–µ–∫</span></div>
                </div>
                <button class="btn" id="retry-test">üîÑ –ü—Ä–æ–π—Ç–∏ —Å–Ω–æ–≤–∞</button>
                <button class="btn back-to-menu">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é</button>
            </div>
        </div>

        <div class="footer">
            <button class="btn btn-reset" id="reset-all">üóëÔ∏è –°–±—Ä–æ—Å–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å</button>
            <p>¬© 2026 TIME WARRIORS ‚Äî Learn English Like a Pro</p>
        </div>
    </div>

    <script>
        // –î–ê–ù–ù–´–ï –ò–ó –§–ê–ô–õ–ê ‚Äî –í–°–ï –§–†–ê–ó–´ –ë–ï–ó –ü–û–í–¢–û–†–û–í
        const timeExpressions = {
            'present-simple': [
                { phrase: 'every morning/day/week/month/year/etc.', hint: 'Used for habits and routines.' },
                { phrase: 'once/twice/three times/etc.', hint: 'Frequency adverbs.' },
                { phrase: 'a day/week/month/year/etc.', hint: 'Duration with frequency.' },
                { phrase: 'always, usually, often, sometimes, seldom, rarely, hardly ever, never', hint: 'Adverbs of frequency.' },
                { phrase: 'in the morning/afternoon/evening, at night', hint: 'Time of day.' },
                { phrase: 'on Mondays/Tuesdays/Wednesdays/etc.', hint: 'Days of the week.' },
                { phrase: 'at the weekends, in the week', hint: 'Weekend vs weekdays.' },
                { phrase: 'all the time', hint: 'Constantly.' },
                { phrase: 'if sentences: if, when, as soon as...', hint: 'Conditional and time clauses.' }
            ],
            'present-continuous': [
                { phrase: 'now, just now, right now', hint: 'Happening at this moment.' },
                { phrase: 'at the/this moment', hint: 'Emphasis on current action.' },
                { phrase: 'at present', hint: 'Currently, at this time.' },
                { phrase: 'these days, nowadays', hint: 'Current trends or situations.' },
                { phrase: 'still', hint: 'Continuing action.' },
                { phrase: 'today', hint: 'Action happening today.' },
                { phrase: 'this morning/week/month/year/etc.', hint: 'Ongoing action within a period.' },
                { phrase: 'tonight (for future)', hint: 'Planned future action.' },
                { phrase: 'Look!, Listen!', hint: 'Signals to pay attention to ongoing action.' }
            ],
            'present-perfect': [
                { phrase: 'just', hint: 'Very recently.' },
                { phrase: 'already', hint: 'Something happened before now.' },
                { phrase: '(not) yet', hint: 'Something hasn\'t happened up to now.' },
                { phrase: 'ever', hint: 'At any time in your life.' },
                { phrase: 'never', hint: 'Not at any time.' },
                { phrase: 'still', hint: 'Continuing situation.' },
                { phrase: 'recently/lately', hint: 'In the near past.' },
                { phrase: 'of late', hint: 'Synonym for recently.' },
                { phrase: 'today', hint: 'When the day is not over.' },
                { phrase: 'so far, till now, up to now', hint: 'From beginning until now.' },
                { phrase: 'This is the first time/second time etc.', hint: 'First experience.' },
                { phrase: 'this morning/week/month/year etc.', hint: 'If the period is not finished.' },
                { phrase: 'in the last two/three/etc. days/weeks/months/', hint: 'Recent period.' },
                { phrase: 'for', hint: 'Duration.' },
                { phrase: 'since', hint: 'Starting point.' },
                { phrase: 'ever since/since then', hint: 'From a point in the past until now.' },
                { phrase: 'How much...?, How many things...?, How many times?', hint: 'Questions about quantity.' },
                { phrase: 'Superlatives', hint: 'With "the most", "the best", etc.' }
            ],
            'present-perfect-continuous': [
                { phrase: 'all morning/day/night/week/etc.', hint: 'Duration of an ongoing action.' },
                { phrase: 'for ? hours/years,...', hint: 'Length of time.' },
                { phrase: 'since', hint: 'Starting point of continuous action.' },
                { phrase: 'ever since/since then', hint: 'From a point until now.' },
                { phrase: 'How long...?', hint: 'Question about duration.' },
                { phrase: 'The whole...', hint: 'Complete period.' }
            ],
            'past-simple': [
                { phrase: 'last night/week/month/year/Monday/etc.', hint: 'Finished past time.' },
                { phrase: 'two/three/etc. minutes/days/weeks/etc. ago', hint: 'Time before now.' },
                { phrase: 'yesterday', hint: 'Day before today.' },
                { phrase: 'the day before yesterday', hint: 'Two days ago.' },
                { phrase: 'the other day', hint: 'Recently, but not specified.' },
                { phrase: 'once, then', hint: 'Single event in the past.' },
                { phrase: 'When...?', hint: 'Asking about specific past time.' },
                { phrase: 'How long ago...?', hint: 'Question about time elapsed.' },
                { phrase: 'in 2003/etc.', hint: 'Specific year in the past.' },
                { phrase: 'if', hint: 'In conditional sentences for hypothetical past.' }
            ],
            'past-continuous': [
                { phrase: 'while/as', hint: 'Background action.' },
                { phrase: 'when', hint: 'Interrupted action.' },
                { phrase: 'as long as', hint: 'Duration in the past.' },
                { phrase: 'this time/at 6 o\'clock/etc. yesterday/last week/etc.', hint: 'Specific past time.' },
                { phrase: 'from 3 to 6/etc. on Monday/etc.', hint: 'Time range in the past.' },
                { phrase: 'at the same moment', hint: 'Simultaneous actions.' }
            ],
            'past-perfect': [
                { phrase: 'just', hint: 'Immediately before another past action.' },
                { phrase: 'already', hint: 'Before another past action.' },
                { phrase: 'never', hint: 'Not before that time.' },
                { phrase: 'for', hint: 'Duration before another past action.' },
                { phrase: 'since', hint: 'Starting point before another past action.' },
                { phrase: 'just/until/till', hint: 'Up to a point in the past.' },
                { phrase: 'when', hint: 'After a point in the past.' },
                { phrase: 'after/before', hint: 'Sequence of events.' },
                { phrase: 'by, by the time, by 5 o\'clock yesterday/etc.', hint: 'Deadline in the past.' },
                { phrase: 'no sooner...than', hint: 'Immediately after.' },
                { phrase: 'until then', hint: 'Up to that point.' },
                { phrase: '(not) yet', hint: 'Not completed before another past action.' },
                { phrase: 'first/second/etc. time', hint: 'Experience before another past action.' },
                { phrase: 'Superlatives', hint: 'With "the most", "the best", etc. in the past.' }
            ],
            'past-perfect-continuous': [
                { phrase: 'since', hint: 'Starting point of continuous action before another past action.' },
                { phrase: 'for', hint: 'Duration of continuous action before another past action.' },
                { phrase: 'all morning/day/night/week/etc.', hint: 'Period of continuous action before another past action.' }
            ],
            'future-simple': [
                { phrase: 'tomorrow', hint: 'Next day.' },
                { phrase: 'the day after tomorrow', hint: 'Two days from now.' },
                { phrase: 'tonight', hint: 'Later today.' },
                { phrase: 'soon', hint: 'In a short time.' },
                { phrase: 'next week/month/year/etc.', hint: 'Following period.' },
                { phrase: 'in 2 days/five minutes/a week/month/year/etc.', hint: 'Time from now.' },
                { phrase: 'in two/three/etc. days/weeks/months/', hint: 'Future duration.' },
                { phrase: 'one day, one of these days', hint: 'Unspecified future time.' },
                { phrase: '(in the) near future', hint: 'Soon, but not exact.' },
                { phrase: 'some day', hint: 'At an unspecified time in the future.' }
            ],
            'future-continuous': [
                { phrase: 'at 6 o\'clock/etc.', hint: 'Specific time in the future.' },
                { phrase: 'tomorrow/next week/etc.', hint: 'Ongoing action in the future.' },
                { phrase: 'at that time', hint: 'At a specific future moment.' },
                { phrase: 'this time on Sunday/etc.', hint: 'Same time next week.' },
                { phrase: 'as usual', hint: 'Regular future action.' },
                { phrase: 'from 9 till 5', hint: 'Time range in the future.' },
                { phrase: 'when', hint: 'During a future action.' },
                { phrase: 'the whole day/week/month/etc.', hint: 'Entire period in the future.' },
                { phrase: 'all day long', hint: 'From morning to night.' }
            ],
            'future-perfect': [
                { phrase: 'at/by this time tomorrow/etc.', hint: 'By a specific future time.' },
                { phrase: 'by 2 O\'clock/etc. tomorrow/etc.', hint: 'Deadline in the future.' },
                { phrase: 'by that time/then/Sunday/now/the end of the year/summer/etc.', hint: 'By a point in the future.' },
                { phrase: 'a day/week from now', hint: 'From now until then.' },
                { phrase: 'next month/year/etc.', hint: 'By the end of the period.' },
                { phrase: 'at this time', hint: 'At a specific future moment.' },
                { phrase: 'when', hint: 'Before another future action.' },
                { phrase: 'Neg.: Yet, still', hint: 'Negative forms with "yet" or "still".' }
            ],
            'future-perfect-continuous': [
                { phrase: 'by... for 2 weeks/a year/etc.', hint: 'Duration up to a future point.' },
                { phrase: 'at this time tomorrow/etc.', hint: 'At a specific future moment.' },
                { phrase: 'a day/week/etc. from now', hint: 'From now until then.' },
                { phrase: 'Next month/year at this time', hint: 'Future point with duration.' }
            ],
            'future-be-going-to': [
                { phrase: 'tomorrow, the day after tomorrow, tonight, soon, next week/month/year/etc.', hint: 'Planned future actions.' },
                { phrase: 'in 2 days/five minutes/a week/month/year/etc.', hint: 'Intentional future actions.' },
                { phrase: 'in two/three/etc. days/weeks/months/', hint: 'Scheduled events.' },
                { phrase: 'one day, one of these days', hint: 'Intended future actions.' },
                { phrase: '(in the) near future', hint: 'Plans for the near future.' },
                { phrase: 'some day', hint: 'Future intention.' }
            ]
        };

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentTab = null;
        let currentData = [];
        let currentIndex = 0;
        let correctCount = 0;
        let totalQuestions = 0;
        let gameActive = false;
        let testStartTime = null;

        // –î–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
        let finalTestQuestions = [];
        let finalTestIndex = 0;
        let finalTestCorrect = 0;
        let finalTestTotal = 0;

        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
        document.addEventListener('DOMContentLoaded', () => {
            showStartMenu();
            
            // –ö–Ω–æ–ø–∫–∞ –Ω–∞—á–∞–ª–∞ –æ–±—É—á–µ–Ω–∏—è
            document.getElementById('start-training').addEventListener('click', () => {
                showMainMenu();
                document.querySelector('.tab').click();
            });
            
            // –ö–Ω–æ–ø–∫–∞ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
            document.getElementById('start-final-test').addEventListener('click', () => {
                startFinalTest();
            });
            
            // –ö–Ω–æ–ø–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –º–µ–Ω—é
            document.getElementById('back-to-main').addEventListener('click', showStartMenu);
            
            // –ö–Ω–æ–ø–∫–∞ —Å–±—Ä–æ—Å–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
            document.getElementById('reset-all').addEventListener('click', resetAllProgress);
            
            // –£–±–∏—Ä–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø—Ä–æ–∫—Ä—É—Ç–∫—É
            // setupMobileAdaptation();
        });

        function showStartMenu() {
            document.getElementById('start-menu').style.display = 'block';
            document.getElementById('main-menu').style.display = 'none';
            document.querySelectorAll('.game-area').forEach(area => {
                area.classList.remove('active');
            });
        }

        function showMainMenu() {
            document.getElementById('start-menu').style.display = 'none';
            document.getElementById('main-menu').style.display = 'flex';
        }

        // –§–ò–ù–ê–õ–¨–ù–´–ô –¢–ï–°–¢
        function startFinalTest() {
            // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã –∏–∑ –≤—Å–µ—Ö –≤—Ä–µ–º–µ–Ω
            finalTestQuestions = [];
            
            for (const [tenseId, expressions] of Object.entries(timeExpressions)) {
                const tenseName = getTenseName(tenseId);
                for (const expr of expressions) {
                    finalTestQuestions.push({
                        phrase: expr.phrase,
                        hint: expr.hint,
                        correctTense: tenseName,
                        tenseId: tenseId
                    });
                }
            }
            
            // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –≤–æ–ø—Ä–æ—Å—ã
            shuffleArray(finalTestQuestions);
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
            finalTestIndex = 0;
            finalTestCorrect = 0;
            finalTestTotal = finalTestQuestions.length;
            testStartTime = Date.now();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ—Å—Ç
            showStartMenu();
            document.getElementById('main-menu').style.display = 'none';
            document.getElementById('start-menu').style.display = 'none';
            
            document.querySelectorAll('.game-area').forEach(area => {
                area.classList.remove('active');
            });
            
            document.getElementById('final-test').classList.add('active');
            document.getElementById('final-test-results').style.display = 'none';
            document.getElementById('final-test').querySelector('.question').style.display = 'block';
            document.getElementById('final-test').querySelector('.options').style.display = 'grid';
            document.getElementById('final-test').querySelector('.btn-next').style.display = 'block';
            document.getElementById('final-test-hint').style.display = 'none';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –≤–æ–ø—Ä–æ—Å–æ–≤
            document.getElementById('current-question').textContent = '1';
            document.getElementById('total-questions').textContent = finalTestTotal;
            document.getElementById('final-test-correct').textContent = '0';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å
            showFinalTestQuestion();
        }

        function showFinalTestQuestion() {
            if (finalTestIndex >= finalTestQuestions.length) {
                showFinalTestResults();
                return;
            }
            
            const question = finalTestQuestions[finalTestIndex];
            document.getElementById('final-test-question').textContent = question.phrase;
            document.getElementById('final-test-hint').textContent = `–ü–æ–¥—Å–∫–∞–∑–∫–∞: ${question.hint}`;
            document.getElementById('current-question').textContent = finalTestIndex + 1;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä
            const progress = (finalTestIndex / finalTestQuestions.length) * 100;
            document.getElementById('final-test-progress').style.width = `${progress}%`;
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
            const options = generateFinalTestOptions(question.correctTense);
            const optionsContainer = document.getElementById('final-test-options');
            optionsContainer.innerHTML = '';
            
            options.forEach(opt => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                optionDiv.textContent = opt.text;
                optionDiv.dataset.correct = opt.correct;
                optionDiv.addEventListener('click', () => checkFinalTestAnswer(optionDiv));
                optionsContainer.appendChild(optionDiv);
            });
        }

        function generateFinalTestOptions(correctTense) {
            const allTenses = [
                'Present Simple', 'Present Continuous', 'Present Perfect', 'Present Perfect Continuous',
                'Past Simple', 'Past Continuous', 'Past Perfect', 'Past Perfect Continuous',
                'Future Simple', 'Future Continuous', 'Future Perfect', 'Future Perfect Continuous', 'Future Be Going To'
            ];
            
            const wrongTenses = allTenses.filter(t => t !== correctTense);
            const wrongOptions = shuffleArray([...wrongTenses]).slice(0, 3);
            
            const options = [
                { text: correctTense, correct: true },
                ...wrongOptions.map(text => ({ text, correct: false }))
            ];
            
            return shuffleArray(options);
        }

        function checkFinalTestAnswer(optionDiv) {
            if (gameActive) return;
            gameActive = true;
            
            const isCorrect = optionDiv.dataset.correct === 'true';
            
            // –û—á–∏—Å—Ç–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∫–ª–∞—Å—Å–æ–≤
            document.querySelectorAll('#final-test .option').forEach(o => {
                o.classList.remove('correct', 'wrong');
            });
            
            if (isCorrect) {
                optionDiv.classList.add('correct');
                finalTestCorrect++;
                document.getElementById('final-test-correct').textContent = finalTestCorrect;
            } else {
                optionDiv.classList.add('wrong');
                document.getElementById('final-test-hint').style.display = 'block';
            }
            
            setTimeout(() => {
                finalTestIndex++;
                gameActive = false;
                showFinalTestQuestion();
            }, isCorrect ? 1000 : 2000);
        }

        function showFinalTestResults() {
            const testTime = Math.floor((Date.now() - testStartTime) / 1000);
            const percentage = Math.round((finalTestCorrect / finalTestTotal) * 100);
            
            document.getElementById('final-test-results').style.display = 'block';
            document.getElementById('final-test').querySelector('.question').style.display = 'none';
            document.getElementById('final-test').querySelector('.options').style.display = 'none';
            document.getElementById('final-test').querySelector('.btn-next').style.display = 'none';
            
            document.getElementById('final-score').textContent = `${percentage}%`;
            document.getElementById('result-total').textContent = finalTestTotal;
            document.getElementById('result-correct').textContent = finalTestCorrect;
            document.getElementById('result-percentage').textContent = `${percentage}%`;
            document.getElementById('result-time').textContent = `${testTime} —Å–µ–∫`;
            
            let grade = '';
            if (percentage >= 90) grade = '‚≠ê –≠–∫—Å–ø–µ—Ä—Ç! ‚≠ê';
            else if (percentage >= 75) grade = 'üéØ –û—Ç–ª–∏—á–Ω–æ!';
            else if (percentage >= 60) grade = 'üëç –•–æ—Ä–æ—à–æ';
            else if (percentage >= 40) grade = 'üìö –ù—É–∂–Ω–æ –ø—Ä–∞–∫—Ç–∏–∫–æ–≤–∞—Ç—å—Å—è';
            else grade = 'üìñ –£—á–∏–º –¥–∞–ª—å—à–µ!';
            
            document.getElementById('final-grade').textContent = grade;
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∫–æ–Ω—Ñ–µ—Ç—Ç–∏ –¥–ª—è —Ö–æ—Ä–æ—à–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            if (percentage >= 75) {
                playConfetti();
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞
            saveTestResult(percentage, finalTestCorrect, finalTestTotal, testTime);
        }

        function saveTestResult(percentage, correct, total, time) {
            const results = JSON.parse(localStorage.getItem('timeWarriorsTestResults') || '[]');
            results.push({
                date: new Date().toISOString(),
                percentage,
                correct,
                total,
                time,
                grade: getGradeFromPercentage(percentage)
            });
            
            // –•—Ä–∞–Ω–∏–º —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            if (results.length > 10) {
                results.shift();
            }
            
            localStorage.setItem('timeWarriorsTestResults', JSON.stringify(results));
        }

        function getGradeFromPercentage(percentage) {
            if (percentage >= 90) return 'A';
            if (percentage >= 75) return 'B';
            if (percentage >= 60) return 'C';
            if (percentage >= 40) return 'D';
            return 'F';
        }

        // –û–°–ù–û–í–ù–ê–Ø –ò–ì–†–ê
        function saveProgress(tabId, correct, total) {
            const progress = JSON.parse(localStorage.getItem('timeWarriorsProgress') || '{}');
            progress[tabId] = { correct, total };
            localStorage.setItem('timeWarriorsProgress', JSON.stringify(progress));
        }

        function loadProgress(tabId) {
            const progress = JSON.parse(localStorage.getItem('timeWarriorsProgress') || '{}');
            return progress[tabId] || { correct: 0, total: 0 };
        }

        function updateProgressBar(tabId) {
            const progress = loadProgress(tabId);
            const fill = progress.total > 0 ? (progress.correct / progress.total) * 100 : 0;
            document.getElementById(`${tabId}-progress`).style.width = `${fill}%`;
            document.getElementById(`${tabId}-correct`).textContent = progress.correct;
            document.getElementById(`${tabId}-total`).textContent = progress.total;
        }

        function resetAllProgress() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤?')) {
                localStorage.removeItem('timeWarriorsProgress');
                localStorage.removeItem('timeWarriorsTestResults');
                alert('–í–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å —Å–±—Ä–æ—à–µ–Ω!');
                location.reload();
            }
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                // –î–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤—Å–µ
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.game-area').forEach(g => g.classList.remove('active'));

                // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é
                tab.classList.add('active');
                const tabId = tab.dataset.tab;
                currentTab = tabId;
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å
                currentData = [...timeExpressions[tabId]];
                shuffleArray(currentData);
                
                const saved = loadProgress(tabId);
                correctCount = saved.correct;
                totalQuestions = saved.total;
                currentIndex = 0;

                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                updateProgressBar(tabId);
                document.getElementById(tabId).classList.add('active');

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å
                showQuestion(tabId);
            });
        });

        function showQuestion(tabId) {
            const gameArea = document.getElementById(tabId);
            
            if (currentIndex >= currentData.length) {
                // –£—Ä–æ–≤–µ–Ω—å –∑–∞–≤–µ—Ä—à—ë–Ω
                gameArea.querySelector('.question').style.display = 'none';
                gameArea.querySelector('.options').style.display = 'none';
                gameArea.querySelector('.btn-next').style.display = 'none';
                gameArea.querySelector('.level-complete').style.display = 'block';
                playConfetti();
                return;
            }

            // –°–±—Ä–æ—Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
            gameArea.querySelector('.question').style.display = 'block';
            gameArea.querySelector('.options').style.display = 'grid';
            gameArea.querySelector('.btn-next').style.display = 'block';
            gameArea.querySelector('.level-complete').style.display = 'none';
            gameArea.querySelector('.hint').style.display = 'none';

            const item = currentData[currentIndex];
            document.getElementById(`${tabId}-question`).textContent = item.phrase;
            document.getElementById(`${tabId}-hint`).textContent = `–ü–æ–¥—Å–∫–∞–∑–∫–∞: ${item.hint}`;

            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
            const options = generateOptions(tabId);
            const optionsContainer = document.getElementById(`${tabId}-options`);
            optionsContainer.innerHTML = '';

            options.forEach(opt => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                optionDiv.textContent = opt.text;
                optionDiv.dataset.correct = opt.correct;
                optionDiv.addEventListener('click', () => checkAnswer(tabId, optionDiv));
                optionsContainer.appendChild(optionDiv);
            });
        }

        function generateOptions(tabId) {
            const correctTense = getTenseName(tabId);
            const allTenses = [
                'Present Simple', 'Present Continuous', 'Present Perfect', 'Present Perfect Continuous',
                'Past Simple', 'Past Continuous', 'Past Perfect', 'Past Perfect Continuous',
                'Future Simple', 'Future Continuous', 'Future Perfect', 'Future Perfect Continuous', 'Future Be Going To'
            ];

            // –£–¥–∞–ª—è–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –∏–∑ —Å–ø–∏—Å–∫–∞
            const wrongTenses = allTenses.filter(t => t !== correctTense);

            // –í—ã–±–∏—Ä–∞–µ–º 3 —Å–ª—É—á–∞–π–Ω—ã—Ö –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö
            const wrongOptions = shuffleArray([...wrongTenses]).slice(0, 3);

            // –°–æ–∑–¥–∞–µ–º –º–∞—Å—Å–∏–≤ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
            const options = [
                { text: correctTense, correct: true },
                ...wrongOptions.map(text => ({ text, correct: false }))
            ];

            // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º
            return shuffleArray(options);
        }

        function getTenseName(tabId) {
            const tenseMap = {
                'present-simple': 'Present Simple',
                'present-continuous': 'Present Continuous',
                'present-perfect': 'Present Perfect',
                'present-perfect-continuous': 'Present Perfect Continuous',
                'past-simple': 'Past Simple',
                'past-continuous': 'Past Continuous',
                'past-perfect': 'Past Perfect',
                'past-perfect-continuous': 'Past Perfect Continuous',
                'future-simple': 'Future Simple',
                'future-continuous': 'Future Continuous',
                'future-perfect': 'Future Perfect',
                'future-perfect-continuous': 'Future Perfect Continuous',
                'future-be-going-to': 'Future Be Going To'
            };
            return tenseMap[tabId];
        }

        function checkAnswer(tabId, optionDiv) {
            if (gameActive) return;
            gameActive = true;

            const isCorrect = optionDiv.dataset.correct === 'true';

            // –û—á–∏—Å—Ç–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∫–ª–∞—Å—Å–æ–≤
            document.querySelectorAll(`#${tabId} .option`).forEach(o => {
                o.classList.remove('correct', 'wrong');
            });

            if (isCorrect) {
                optionDiv.classList.add('correct');
                correctCount++;
                totalQuestions++;
                saveProgress(tabId, correctCount, totalQuestions);
                updateProgressBar(tabId);
                
                setTimeout(() => {
                    currentIndex++;
                    gameActive = false;
                    showQuestion(tabId);
                }, 1000);
            } else {
                optionDiv.classList.add('wrong');
                totalQuestions++;
                saveProgress(tabId, correctCount, totalQuestions);
                updateProgressBar(tabId);
                document.getElementById(`${tabId}-hint`).style.display = 'block';
                
                setTimeout(() => {
                    gameActive = false;
                }, 2000);
            }
        }

        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function playConfetti() {
            const confettiContainer = document.createElement('div');
            confettiContainer.className = 'confetti';
            document.body.appendChild(confettiContainer);

            for (let i = 0; i < 100; i++) {
                const piece = document.createElement('div');
                piece.className = 'confetti-piece';
                piece.style.left = Math.random() * 100 + '%';
                piece.style.backgroundColor = ['#00f7ff', '#ff00aa', '#ffd700'][Math.floor(Math.random() * 3)];
                piece.style.animationDuration = (Math.random() * 3 + 2) + 's';
                confettiContainer.appendChild(piece);
            }

            setTimeout(() => {
                confettiContainer.remove();
            }, 3000);
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫
        document.addEventListener('click', (e) => {
            // –ö–Ω–æ–ø–∫–∞ "–°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å" –¥–ª—è –æ–±—ã—á–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π
            if (e.target.classList.contains('btn-next') && !e.target.id.includes('final-test')) {
                const tabId = e.target.id.replace('-next', '');
                currentIndex++;
                showQuestion(tabId);
            }
            
            // –ö–Ω–æ–ø–∫–∞ "–°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å" –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
            if (e.target.id === 'final-test-next') {
                finalTestIndex++;
                showFinalTestQuestion();
            }
            
            // –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —É—Ä–æ–≤–Ω—é
            if (e.target.classList.contains('btn-next-level')) {
                const nextTab = e.target.dataset.next;
                document.querySelector(`.tab[data-tab="${nextTab}"]`).click();
            }
            
            // –ö–Ω–æ–ø–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –º–µ–Ω—é
            if (e.target.classList.contains('back-to-menu')) {
                showStartMenu();
            }
            
            // –ö–Ω–æ–ø–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–∞
            if (e.target.id === 'retry-test') {
                startFinalTest();
            }
        });

        // –ù–∞—á–∏–Ω–∞–µ–º —Å –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –º–µ–Ω—é
        showStartMenu();
    </script>
</body>
</html>
